<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Stability attributes - Guide to Rustc Development</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A guide to developing rustc">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded affix "><a href="about-this-guide.html">About this guide</a></li><li class="spacer"></li><li class="expanded "><a href="part-1-intro.html"><strong aria-hidden="true">1.</strong> Part 1: Building, debugging, and contributing to Rustc</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="compiler-team.html"><strong aria-hidden="true">1.1.</strong> About the compiler team</a></li><li class=""><a href="building/how-to-build-and-run.html"><strong aria-hidden="true">1.2.</strong> How to Build and Run the Compiler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="building/suggested.html"><strong aria-hidden="true">1.2.1.</strong> Suggested Workflows</a></li><li class=""><a href="building/bootstrapping.html"><strong aria-hidden="true">1.2.2.</strong> Bootstrapping</a></li><li class=""><a href="building/build-install-distribution-artifacts.html"><strong aria-hidden="true">1.2.3.</strong> Distribution artifacts</a></li><li class=""><a href="building/compiler-documenting.html"><strong aria-hidden="true">1.2.4.</strong> Documenting Compiler</a></li><li class=""><a href="building/ctags.html"><strong aria-hidden="true">1.2.5.</strong> ctags</a></li></ol></li><li class=""><a href="tests/intro.html"><strong aria-hidden="true">1.3.</strong> The compiler testing framework</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="tests/running.html"><strong aria-hidden="true">1.3.1.</strong> Running tests</a></li><li class=""><a href="tests/adding.html"><strong aria-hidden="true">1.3.2.</strong> Adding new tests</a></li><li class=""><a href="compiletest.html"><strong aria-hidden="true">1.3.3.</strong> Using compiletest + commands to control test execution</a></li></ol></li><li class=""><a href="walkthrough.html"><strong aria-hidden="true">1.4.</strong> Walkthrough: a typical contribution</a></li><li class=""><a href="bug-fix-procedure.html"><strong aria-hidden="true">1.5.</strong> Bug Fix Procedure</a></li><li class=""><a href="implementing_new_features.html"><strong aria-hidden="true">1.6.</strong> Implementing new features</a></li><li class="expanded "><a href="stability.html" class="active"><strong aria-hidden="true">1.7.</strong> Stability attributes</a></li><li class=""><a href="stabilization_guide.html"><strong aria-hidden="true">1.8.</strong> Stabilizing Features</a></li><li class=""><a href="compiler-debugging.html"><strong aria-hidden="true">1.9.</strong> Debugging the Compiler</a></li><li class=""><a href="profiling.html"><strong aria-hidden="true">1.10.</strong> Profiling the compiler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="profiling/with_perf.html"><strong aria-hidden="true">1.10.1.</strong> with the linux perf tool</a></li></ol></li><li class=""><a href="conventions.html"><strong aria-hidden="true">1.11.</strong> Coding conventions</a></li><li class=""><a href="crates-io.html"><strong aria-hidden="true">1.12.</strong> crates.io Dependencies</a></li><li class=""><a href="diagnostics.html"><strong aria-hidden="true">1.13.</strong> Emitting Errors and other Diagnostics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="diagnostics/lintstore.html"><strong aria-hidden="true">1.13.1.</strong> LintStore</a></li><li class=""><a href="diagnostics/diagnostic-codes.html"><strong aria-hidden="true">1.13.2.</strong> Diagnostic Codes</a></li></ol></li><li class=""><a href="ice-breaker/about.html"><strong aria-hidden="true">1.14.</strong> ICE-breaker teams</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="ice-breaker/cleanup-crew.html"><strong aria-hidden="true">1.14.1.</strong> &quot;Cleanup Crew&quot; ICE-breakers</a></li><li class=""><a href="ice-breaker/llvm.html"><strong aria-hidden="true">1.14.2.</strong> LLVM ICE-breakers</a></li></ol></li><li class=""><a href="licenses.html"><strong aria-hidden="true">1.15.</strong> Licenses</a></li></ol></li><li class="expanded "><a href="part-2-intro.html"><strong aria-hidden="true">2.</strong> Part 2: How rustc works</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="high-level-overview.html"><strong aria-hidden="true">2.1.</strong> High-level overview of the compiler source</a></li><li class=""><a href="rustc-driver.html"><strong aria-hidden="true">2.2.</strong> The Rustc Driver and Interface</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="rustdoc.html"><strong aria-hidden="true">2.2.1.</strong> Rustdoc</a></li></ol></li><li class=""><a href="query.html"><strong aria-hidden="true">2.3.</strong> Queries: demand-driven compilation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="queries/query-evaluation-model-in-detail.html"><strong aria-hidden="true">2.3.1.</strong> The Query Evaluation Model in Detail</a></li><li class=""><a href="queries/incremental-compilation.html"><strong aria-hidden="true">2.3.2.</strong> Incremental compilation</a></li><li class=""><a href="queries/incremental-compilation-in-detail.html"><strong aria-hidden="true">2.3.3.</strong> Incremental compilation In Detail</a></li><li class=""><a href="incrcomp-debugging.html"><strong aria-hidden="true">2.3.4.</strong> Debugging and Testing</a></li><li class=""><a href="queries/profiling.html"><strong aria-hidden="true">2.3.5.</strong> Profiling Queries</a></li><li class=""><a href="salsa.html"><strong aria-hidden="true">2.3.6.</strong> Salsa</a></li></ol></li><li class=""><a href="memory.html"><strong aria-hidden="true">2.4.</strong> Memory Management in Rustc</a></li><li class=""><a href="the-parser.html"><strong aria-hidden="true">2.5.</strong> Lexing and Parsing</a></li><li class=""><a href="test-implementation.html"><strong aria-hidden="true">2.6.</strong> #[test] Implementation</a></li><li class=""><a href="panic-implementation.html"><strong aria-hidden="true">2.7.</strong> Panic Implementation</a></li><li class=""><a href="macro-expansion.html"><strong aria-hidden="true">2.8.</strong> Macro expansion</a></li><li class=""><a href="name-resolution.html"><strong aria-hidden="true">2.9.</strong> Name resolution</a></li><li class=""><a href="hir.html"><strong aria-hidden="true">2.10.</strong> The HIR (High-level IR)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="lowering.html"><strong aria-hidden="true">2.10.1.</strong> Lowering AST to HIR</a></li><li class=""><a href="hir-debugging.html"><strong aria-hidden="true">2.10.2.</strong> Debugging</a></li></ol></li><li class=""><a href="closure.html"><strong aria-hidden="true">2.11.</strong> Closure expansion</a></li><li class=""><a href="ty.html"><strong aria-hidden="true">2.12.</strong> The ty module: representing types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="generics.html"><strong aria-hidden="true">2.12.1.</strong> Generics and substitutions</a></li><li class=""><a href="ty-fold.html"><strong aria-hidden="true">2.12.2.</strong> TypeFolder and TypeFoldable</a></li><li class=""><a href="generic_arguments.html"><strong aria-hidden="true">2.12.3.</strong> Generic arguments</a></li></ol></li><li class=""><a href="type-inference.html"><strong aria-hidden="true">2.13.</strong> Type inference</a></li><li class=""><a href="traits/resolution.html"><strong aria-hidden="true">2.14.</strong> Trait solving (old-style)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="traits/hrtb.html"><strong aria-hidden="true">2.14.1.</strong> Higher-ranked trait bounds</a></li><li class=""><a href="traits/caching.html"><strong aria-hidden="true">2.14.2.</strong> Caching subtleties</a></li><li class=""><a href="traits/specialization.html"><strong aria-hidden="true">2.14.3.</strong> Specialization</a></li></ol></li><li class=""><a href="traits/index.html"><strong aria-hidden="true">2.15.</strong> Trait solving (new-style)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="traits/lowering-to-logic.html"><strong aria-hidden="true">2.15.1.</strong> Lowering to logic</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="traits/goals-and-clauses.html"><strong aria-hidden="true">2.15.1.1.</strong> Goals and clauses</a></li><li class=""><a href="traits/associated-types.html"><strong aria-hidden="true">2.15.1.2.</strong> Equality and associated types</a></li><li class=""><a href="traits/implied-bounds.html"><strong aria-hidden="true">2.15.1.3.</strong> Implied bounds</a></li><li class=""><a href="traits/regions.html"><strong aria-hidden="true">2.15.1.4.</strong> Region constraints</a></li><li class=""><a href="traits/lowering-module.html"><strong aria-hidden="true">2.15.1.5.</strong> The lowering module in rustc</a></li><li class=""><a href="traits/lowering-rules.html"><strong aria-hidden="true">2.15.1.6.</strong> Lowering rules</a></li><li class=""><a href="traits/wf.html"><strong aria-hidden="true">2.15.1.7.</strong> Well-formedness checking</a></li></ol></li><li class=""><a href="traits/canonical-queries.html"><strong aria-hidden="true">2.15.2.</strong> Canonical queries</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="traits/canonicalization.html"><strong aria-hidden="true">2.15.2.1.</strong> Canonicalization</a></li></ol></li><li class=""><a href="traits/slg.html"><strong aria-hidden="true">2.15.3.</strong> The SLG solver</a></li><li class=""><a href="traits/chalk-overview.html"><strong aria-hidden="true">2.15.4.</strong> An Overview of Chalk</a></li><li class=""><a href="traits/bibliography.html"><strong aria-hidden="true">2.15.5.</strong> Bibliography</a></li></ol></li><li class=""><a href="type-checking.html"><strong aria-hidden="true">2.16.</strong> Type checking</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="method-lookup.html"><strong aria-hidden="true">2.16.1.</strong> Method Lookup</a></li><li class=""><a href="variance.html"><strong aria-hidden="true">2.16.2.</strong> Variance</a></li><li class=""><a href="opaque-types-type-alias-impl-trait.html"><strong aria-hidden="true">2.16.3.</strong> Opaque Types</a></li></ol></li><li class=""><a href="mir/index.html"><strong aria-hidden="true">2.17.</strong> The MIR (Mid-level IR)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="mir/construction.html"><strong aria-hidden="true">2.17.1.</strong> MIR construction</a></li><li class=""><a href="mir/visitor.html"><strong aria-hidden="true">2.17.2.</strong> MIR visitor and traversal</a></li><li class=""><a href="mir/passes.html"><strong aria-hidden="true">2.17.3.</strong> MIR passes: getting the MIR for a function</a></li><li class=""><a href="mir/optimizations.html"><strong aria-hidden="true">2.17.4.</strong> MIR optimizations</a></li><li class=""><a href="mir/debugging.html"><strong aria-hidden="true">2.17.5.</strong> Debugging</a></li></ol></li><li class=""><a href="borrow_check.html"><strong aria-hidden="true">2.18.</strong> The borrow checker</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="borrow_check/moves_and_initialization.html"><strong aria-hidden="true">2.18.1.</strong> Tracking moves and initialization</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="borrow_check/moves_and_initialization/move_paths.html"><strong aria-hidden="true">2.18.1.1.</strong> Move paths</a></li></ol></li><li class=""><a href="borrow_check/type_check.html"><strong aria-hidden="true">2.18.2.</strong> MIR type checker</a></li><li class=""><a href="borrow_check/region_inference.html"><strong aria-hidden="true">2.18.3.</strong> Region inference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="borrow_check/region_inference/constraint_propagation.html"><strong aria-hidden="true">2.18.3.1.</strong> Constraint propagation</a></li><li class=""><a href="borrow_check/region_inference/lifetime_parameters.html"><strong aria-hidden="true">2.18.3.2.</strong> Lifetime parameters</a></li><li class=""><a href="borrow_check/region_inference/member_constraints.html"><strong aria-hidden="true">2.18.3.3.</strong> Member constraints</a></li><li class=""><a href="borrow_check/region_inference/placeholders_and_universes.html"><strong aria-hidden="true">2.18.3.4.</strong> Placeholders and universes</a></li><li class=""><a href="borrow_check/region_inference/closure_constraints.html"><strong aria-hidden="true">2.18.3.5.</strong> Closure constraints</a></li><li class=""><a href="borrow_check/region_inference/error_reporting.html"><strong aria-hidden="true">2.18.3.6.</strong> Error reporting</a></li></ol></li><li class=""><a href="borrow_check/two_phase_borrows.html"><strong aria-hidden="true">2.18.4.</strong> Two-phase-borrows</a></li></ol></li><li class=""><a href="const-eval.html"><strong aria-hidden="true">2.19.</strong> Constant evaluation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="miri.html"><strong aria-hidden="true">2.19.1.</strong> miri const evaluator</a></li></ol></li><li class=""><a href="param_env.html"><strong aria-hidden="true">2.20.</strong> Parameter Environments</a></li><li class=""><a href="backend/backend.html"><strong aria-hidden="true">2.21.</strong> Compiler Backend</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="backend/monomorph.html"><strong aria-hidden="true">2.21.1.</strong> Monomorphization</a></li><li class=""><a href="backend/lowering-mir.html"><strong aria-hidden="true">2.21.2.</strong> Lowering MIR</a></li><li class=""><a href="backend/codegen.html"><strong aria-hidden="true">2.21.3.</strong> Code Generation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="backend/updating-llvm.html"><strong aria-hidden="true">2.21.3.1.</strong> Updating LLVM</a></li><li class=""><a href="backend/debugging.html"><strong aria-hidden="true">2.21.3.2.</strong> Debugging LLVM</a></li><li class=""><a href="backend/backend-agnostic.html"><strong aria-hidden="true">2.21.3.3.</strong> Backend Agnostic Codegen</a></li></ol></li><li class=""><a href="profile-guided-optimization.html"><strong aria-hidden="true">2.21.4.</strong> Profile-guided Optimization</a></li><li class=""><a href="sanitizers.html"><strong aria-hidden="true">2.21.5.</strong> Sanitizers Support</a></li><li class=""><a href="debugging-support-in-rustc.html"><strong aria-hidden="true">2.21.6.</strong> Debugging Support in Rust Compiler</a></li><li class="spacer"></li></ol></li></ol></li><li class="expanded "><a href="appendix/stupid-stats.html">Appendix A: Stupid Stats</a></li><li class="expanded affix "><a href="appendix/background.html">Appendix B: Background material</a></li><li class="expanded affix "><a href="appendix/glossary.html">Appendix C: Glossary</a></li><li class="expanded affix "><a href="appendix/code-index.html">Appendix D: Code Index</a></li><li class="expanded affix "><a href="appendix/compiler-lecture.html">Appendix E: Compiler Lecture Series</a></li><li class="expanded affix "><a href="appendix/bibliography.html">Appendix F: Bibliography</a></li><li class="expanded affix "><a href="appendix/humorust.html">Appendix Z: HumorRust</a></li><li class="spacer"></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Guide to Rustc Development</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                            <a href="https://github.com/rust-lang/rustc-dev-guide" title="Git repository" aria-label="Git repository">
                                <i id="git-repository-button" class="fa fa-github"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#stability-attributes" id="stability-attributes">Stability attributes</a></h1>
<p>This section is about the stability attributes and schemes that allow stable
APIs to use unstable APIs internally in the rustc standard library.</p>
<p>For instructions on stabilizing a language feature see <a href="./stabilization_guide.html">Stabilizing
Features</a>.</p>
<h2><a class="header" href="#unstable" id="unstable">unstable</a></h2>
<p>The <code>#[unstable(feature = &quot;foo&quot;, issue = &quot;1234&quot;, reason = &quot;lorem ipsum&quot;)]</code>
attribute explicitly marks an item as unstable. Items that are marked as
&quot;unstable&quot; cannot be used without a corresponding <code>#![feature]</code> attribute on
the crate, even on a nightly compiler. This restriction only applies across
crate boundaries, unstable items may be used within the crate that defines
them.</p>
<p>The <code>issue</code> field specifies the associated GitHub <a href="https://github.com/rust-lang/rust/issues">issue number</a>. This field is
required and all unstable features should have an associated tracking issue. In
rare cases where there is no sensible value <code>issue = &quot;none&quot;</code> is used.</p>
<p>The <code>unstable</code> attribute infects all sub-items, where the attribute doesn't
have to be reapplied. So if you apply this to a module, all items in the module
will be unstable.</p>
<p>You can make specific sub-items stable by using the <code>#[stable]</code> attribute on
them. The stability scheme works similarly to how <code>pub</code> works. You can have
public functions of nonpublic modules and you can have stable functions in
unstable modules or vice versa.</p>
<p>Note, however, that due to a <a href="https://github.com/rust-lang/rust/issues/15702">rustc bug</a>, stable items inside unstable modules
<em>are</em> available to stable code in that location!  So, for example, stable code
can import <code>core::intrinsics::transmute</code> even though <code>intrinsics</code> is an
unstable module.  Thus, this kind of nesting should be avoided when possible.</p>
<p>The <code>unstable</code> attribute may also have the <code>soft</code> value, which makes it a
future-incompatible deny-by-default lint instead of a hard error. This is used
by the <code>bench</code> attribute which was accidentally accepted in the past. This
prevents breaking dependencies by leveraging Cargo's lint capping.</p>
<h2><a class="header" href="#stable" id="stable">stable</a></h2>
<p>The <code>#[stable(feature = &quot;foo&quot;, &quot;since = &quot;1.420.69&quot;)]</code> attribute explicitly
marks an item as stabilized. To do this, follow the instructions in
<a href="./stabilization_guide.html">Stabilizing Features</a>.</p>
<p>Note that stable functions may use unstable things in their body.</p>
<h2><a class="header" href="#rustc_const_unstable" id="rustc_const_unstable">rustc_const_unstable</a></h2>
<p>The <code>#[rustc_const_unstable(feature = &quot;foo&quot;, issue = &quot;1234&quot;, reason = &quot;lorem ipsum&quot;)]</code>
has the same interface as the <code>unstable</code> attribute. It is used to mark
<code>const fn</code> as having their constness be unstable. This allows you to make a
function stable without stabilizing its constness or even just marking an existing
stable function as <code>const fn</code> without instantly stabilizing the <code>const fn</code>ness.</p>
<p>Furthermore this attribute is needed to mark an intrinsic as <code>const fn</code>, because
there's no way to add <code>const</code> to functions in <code>extern</code> blocks for now.</p>
<h2><a class="header" href="#rustc_const_stable" id="rustc_const_stable">rustc_const_stable</a></h2>
<p>The <code>#[stable(feature = &quot;foo&quot;, &quot;since = &quot;1.420.69&quot;)]</code> attribute explicitly marks
a <code>const fn</code> as having its constness be <code>stable</code>. This attribute can make sense
even on an <code>unstable</code> function, if that function is called from another
<code>rustc_const_stable</code> function.</p>
<p>Furthermore this attribute is needed to mark an intrinsic as callable from
<code>rustc_const_stable</code> functions.</p>
<h2><a class="header" href="#allow_internal_unstable" id="allow_internal_unstable">allow_internal_unstable</a></h2>
<p>Macros, compiler desugarings and <code>const fn</code>s expose their bodies to the call
site. To work around not being able to use unstable things in the standard
library's macros, there's the <code>#[allow_internal_unstable(feature1, feature2)]</code>
attribute that whitelists the given features for usage in stable macros or
<code>const fn</code>s.</p>
<p>Note that <code>const fn</code>s are even more special in this regard. You can't just
whitelist any feature, the features need an implementation in
<code>qualify_min_const_fn.rs</code>. For example the <code>const_fn_union</code> feature gate allows
accessing fields of unions inside stable <code>const fn</code>s. The rules for when it's
ok to use such a feature gate are that behavior matches the runtime behavior of
the same code (see also <a href="https://www.ralfj.de/blog/2018/07/19/const.html">this blog post</a>). This means that you may not
create a <code>const fn</code> that e.g. transmutes a memory address to an integer,
because the addresses of things are nondeterministic and often unknown at
compile-time.</p>
<p>Always ping @oli-obk, @RalfJung, and @Centril if you are adding more
<code>allow_internal_unstable</code> attributes to any <code>const fn</code></p>
<h2><a class="header" href="#staged_api" id="staged_api">staged_api</a></h2>
<p>Any crate that uses the <code>stable</code>, <code>unstable</code>, or <code>rustc_deprecated</code> attributes
must include the <code>#![feature(staged_api)]</code> attribute on the crate.</p>
<h2><a class="header" href="#rustc_deprecated" id="rustc_deprecated">rustc_deprecated</a></h2>
<p>The deprecation system shares the same infrastructure as the stable/unstable
attributes. The <code>rustc_deprecated</code> attribute is similar to the <a href="https://doc.rust-lang.org/reference/attributes/diagnostics.html#the-deprecated-attribute"><code>deprecated</code>
attribute</a>. It was previously called <code>deprecated</code>, but was split off when
<code>deprecated</code> was stabilized. The <code>deprecated</code> attribute cannot be used in a
<code>staged_api</code> crate, <code>rustc_deprecated</code> must be used instead. The deprecated
item must also have a <code>stable</code> or <code>unstable</code> attribute.</p>
<p><code>rustc_deprecated</code> has the following form:</p>
<pre><code class="language-rust ignore">#[rustc_deprecated(
    since = &quot;1.38.0&quot;,
    reason = &quot;explanation for deprecation&quot;,
    suggestion = &quot;other_function&quot;
)]
</code></pre>
<p>The <code>suggestion</code> field is optional. If given, it should be a string that can be
used as a machine-applicable suggestion to correct the warning. This is
typically used when the identifier is renamed, but no other significant changes
are necessary.</p>
<p>Another difference from the <code>deprecated</code> attribute is that the <code>since</code> field is
actually checked against the current version of <code>rustc</code>. If <code>since</code> is in a
future version, then the <code>deprecated_in_future</code> lint is triggered which is
default <code>allow</code>, but most of the standard library raises it to a warning with
<code>#![warn(deprecated_in_future)]</code>.</p>
<h2><a class="header" href="#-zforce-unstable-if-unmarked" id="-zforce-unstable-if-unmarked">-Zforce-unstable-if-unmarked</a></h2>
<p>The <code>-Zforce-unstable-if-unmarked</code> flag has a variety of purposes to help
enforce that the correct crates are marked as unstable. It was introduced
primarily to allow rustc and the standard library to link to arbitrary crates
on crates.io which do not themselves use <code>staged_api</code>. <code>rustc</code> also relies on
this flag to mark all of its crates as unstable with the <code>rustc_private</code>
feature so that each crate does not need to be carefully marked with
<code>unstable</code>.</p>
<p>This flag is automatically applied to all of <code>rustc</code> and the standard library
by the bootstrap scripts. This is needed because the compiler and all of its
dependencies are shipped in the sysroot to all users.</p>
<p>This flag has the following effects:</p>
<ul>
<li>Marks the crate as &quot;unstable&quot; with the <code>rustc_private</code> feature if it is not
itself marked as stable or unstable.</li>
<li>Allows these crates to access other forced-unstable crates without any need
for attributes. Normally a crate would need a <code>#![feature(rustc_private)]</code>
attribute to use other unstable crates. However, that would make it
impossible for a crate from crates.io to access its own dependencies since
that crate won't have a <code>feature(rustc_private)</code> attribute, but <em>everything</em>
is compiled with <code>-Zforce-unstable-if-unmarked</code>.</li>
</ul>
<p>Code which does not use <code>-Zforce-unstable-if-unmarked</code> should include the
<code>#![feature(rustc_private)]</code> crate attribute to access these force-unstable
crates. This is needed for things that link <code>rustc</code>, such as <code>miri</code>, <code>rls</code>, or
<code>clippy</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="implementing_new_features.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="stabilization_guide.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="implementing_new_features.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="stabilization_guide.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
